# Overview
---
This directory includes scripts and descriptions for running example Auths and entities.
The scripts are used to clean and generate credentials (certificates and keystores) for example Auths and entities.

# Example details
---
![Image of Example Auths and entities](https://raw.githubusercontent.com/iotauth/iotauth/master/examples/figures/example_description.png)

The figure above illustrates the example with two Auths (*Auth101* and *Auth102*) and their example entities. *Auth101* (Auth with ID 101) is an authorization entity for network 1 (net1), and it has two registered entities, namely, *net1.server* and *net1.client*. *Auth102* (Auth with ID 102) is for network 2 (net2) with two registered entities, *net2.server* and *net2.client*.

Each Auth has its own public keys (or certificates) and keystores in the directory, *auth/credentials/*. Each entity has its own public key and private key in the directory, *entity/credentials/*. These credentials (public keys and private keys) can be generated by running a script (generateExampleAuthsEntities.sh) included in this directory. 

Each Auth stores public keys of its registered entities, and each entity stores its Auth's public key. The script (generateExampleAuthsEntities.sh) also exchanges the public keys between each Auth and its entities by copying them. The Auths store the public keys of their entities as part of their databases, specifically, in the directories, *auth/databases/auth101/certs/* and *auth/databases/auth102/certs/*. For entities, the public keys of Auths are stored in the directory, *entity/auth_certs/*.

Database tables for storing authorization information should be initialized for each eaxample Auth. The script (generateExampleAuthsEntities.sh) does this database initialization as the last step of the script. The initialized databases are created for *Auth101* and *Auth102* in the directorories, *auth/databases/auth101* and *auth/databases/auth101*, respectively, with the file name *auth.db*. Currently, we use SQLite for Auth databases.

# Script details
---
### generateExampleAuthsEntities.sh

This script generates credentials for example Auths and example entities. And it copies certificates (public keys) of entities to Auths' databases, and copies certificates (public keys) of Auths to entities' local directories. This script uses following helper scripts.

- **auth/credentials/generateCACredentials.sh**: This helper script generates credentials (public key, private key) for certificate authority which signs certificates of example Auths and entities.

- **auth/credentials/generateExampleAuthCredentials.sh**: This helper script generates credentials for example Auths.

- **entity/credentials/generateExampleEntityCredentials.sh**: This helper script generates credentials for example entities.

- **auth/example-auth-db-generator/generateExampleAuthDB.sh**: This helper script generates databases for Example Auths

### cleanExampleAuthsEntities.sh

This scripts deletes all credentials of example Auths and entities, and deletes databases for example Auths

# How to Run examples
---
If the script (generateExampleAuthsEntities.sh) finishes without an error, the credentials for Auths and entities and databases for Auths should be created.

